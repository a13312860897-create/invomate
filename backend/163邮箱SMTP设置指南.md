# 163邮箱SMTP设置指南

## 问题诊断
当前邮件发送失败的原因是：**535 Error: authentication failed**

这个错误表明163邮箱的SMTP认证失败，主要原因是：
1. 没有开启SMTP服务
2. 没有设置客户端授权码
3. 使用了邮箱登录密码而不是授权码

## 解决步骤

### 1. 登录163邮箱网页版
- 访问：https://mail.163.com
- 使用您的邮箱账号登录：a13312860897@163.com

### 2. 开启SMTP服务
1. 点击右上角的"设置"
2. 选择"POP3/SMTP/IMAP"
3. 勾选"开启SMTP服务"
4. 勾选"开启POP3/SMTP服务"

### 3. 设置客户端授权码（重要！）
1. 在同一页面找到"客户端授权密码"
2. 点击"开启"或"设置"
3. 系统会要求您输入手机验证码
4. 设置一个授权码（建议使用字母+数字组合）
5. **记住这个授权码，这就是SMTP密码！**

### 4. 更新配置文件
将生成的授权码更新到 `.env` 文件中：

```env
SMTP_PASS=您的新授权码
```

**注意：不是邮箱登录密码，是刚才设置的授权码！**

### 5. 推荐的163邮箱SMTP配置
```
SMTP_HOST=smtp.163.com
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=a13312860897@163.com
SMTP_PASS=您的授权码（不是登录密码）
```

## 常见问题

### Q: 为什么不能使用邮箱登录密码？
A: 为了安全考虑，163邮箱要求第三方应用使用专门的授权码，而不是登录密码。

### Q: 授权码忘记了怎么办？
A: 可以重新设置授权码，旧的会失效。

### Q: 还是提示认证失败？
A: 请检查：
1. 授权码是否正确复制（注意空格）
2. SMTP服务是否已开启
3. 网络是否正常

## 测试步骤
1. 更新授权码后，重启后端服务器
2. 访问邮件测试页面进行测试
3. 如果还有问题，可以运行测试脚本：`node test-smtp-direct.js`